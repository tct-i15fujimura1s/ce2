# 確率

信号は送信側からすれば決定的だが、受信側からすると確率的（未知なので）

ノイズも確率性がある

## 用語

- 試行
- 結果: 試行の結果として期待される区別可能な特徴
- 事象: 共通の性質を持つ試行結果の部分集合
- 標本空間: 結果の全体集合
- 要素、標本点: 結果の一つ

## 相対度数

試行回数を増やすにつれて、事象 $A$ が起きる割合はある値に近づいていく

- $N$: 試行回数
- $N(A)$: $N$ 回の試行のうち、事象 $A$ が起きた回数


相対度数

$$f(A) = \lim_{N \to \infty} \frac{N(A)}{N}$$

確率

$$P(A) = \lim_{N \to \infty} \frac{N(A)}{N}$$

$0 \le P(A) \le 1$

## 例題

### 例題1

図（プリント参照）の 6 つの要素について、その確率を示せ。

- $P(\zeta_n) = \frac{1}{6}$

### 例題2

図の事象 $A_e, A_o, B, A_e \cap B, A_o \cap B$ についてその確率を示せ

- $P(A_e) = \frac{1}{2}$
- $P(A_o) = \frac{1}{2}$
- $P(B) = \frac{2}{3}$
- $P(A_e \cap B) = \frac{1}{3}$
- $P(A_o \cap B) = \frac{1}{3}$

### 例題3

2 つのサイコロを振った時、 2 つの目の合計が 7 になる確率を求めなさい。

$|\{(1, 6), (2, 5), (3, 4), (4, 3), (5, 2), (6, 1)\}| = 6$

答えは $\frac{6}{36} = \frac{1}{6}$

### 例題4

コインを 4 回投げたとき、 2 回表となる確率を求めなさい。

答えは $\frac{_4 {\rm C} _2}{2^4} = \frac{3}{8}$

$[x^2] (1 + x)^4 = [x^2] (1 + 4x + 6x^2 + 4x^3 + x^4) = 6$

### 例題5

トランプを続けて 2 枚引く時（非復元）、赤のエースを 2 枚引く確率を求めなさい。

- 赤のエースは 2 枚ある
- トランプは $13×4+2 = 54$ 枚ある

54 枚から 2 回引く方法のうち、ある 2 枚を 2 回引く方法

$\frac{_2 {\rm P} _2}{_{54} {\rm P} _2} = \frac{1}{1431}$

### 例題 6

2 元対称通信路 (BSC) により $n$ ビットを送るときに $k$ ビットが誤る確率を求めなさい。ただし、ビット誤り率を $P_e$ とする。

$_n {\rm C} _k \times {P_e}^{k} \times {(1 - P_e)}^{n - k}$

### 例題 7

再生中継しながら $n$ 本のリンクを伝送する時のビット誤り率 $P_e$ を求めなさい。ただし、一つのリンクにおけるビット誤り率を $P_e$ とする。

$2$ 回誤ったらもとに戻る→奇数回誤る確率の総和

$$
\begin{aligned}
&\quad (1 - P_e) \sum_{k = 0}^{\lfloor \frac{n + 1}{2} \rfloor} {_n} {\rm C} _{2k+1} \times \left( \frac{P_e}{1-P_e} \right)^{2k+1} \\

&= P_e \sum_{k = 0}^{\lfloor \frac{n + 1}{2} \rfloor} {_n} {\rm C} _{2k+1} \times \left( \frac{P_e}{1-P_e} \right)^{2k}

\end{aligned}$$

### 例題 8

- 3 ビットで 1 メッセージを送る
- 受信側では $000$, $111$ の近い方とする
- 1 メッセージあたりの誤り率は？

$3 \times {P_e}^2 \times (1-P_e) + {P_e}^3$

### 例題 9

正常なダイオードが $N_g$ 個、不良のダイオードが $N_b$ 個ある。

$5$ つのダイオードをつなぐとき、良、不良、良、良、不良の順になる確率

$\frac{N_g \times N_b \times (N_g - 1) \times (N_g - 2) \times (N_b - 1)}{(N_g + N_b)!}$

### 例題 10

$N$ 通りの異なるパターンにおいて誤りが発生する

それぞれのパターンになる確率を $p_i$ 、パターンごとに誤りが発生する確率は $q_i$ であるとする

パターンは背反な事象なので、総和をとるとよい

$$\sum_i p_i q_i$$

### 例題 11

通信システムはいつも　３つの干渉信号の一つにさらされていて、そのいずれかが原因で障害が起こる。

その干渉信号の発生確率をそれぞれ 0.8, 0.16, 0.04 とする。また、それぞれの干渉信号がシステムをストップさせる確率を 0.01, 0.1, 0.4 とする。システムがストップしたときにそれぞれの干渉信号が発生していた確率を求めなさい。

$i$ 番目の干渉信号が発生する事象を $p_i$ 、システムがストップする事象を $q$ とする。

- $P(p_1) = 0.8$
- $P(p_2) = 0.16$
- $P(p_3) = 0.04$
- $P(p_1 | q) = 0.01$
- $P(p_2 | q) = 0.1$
- $P(p_3 | q) = 0.4$

求めたいものは $P(q | p_1), P(q | p_2), P(q | p_3)$

$$P(q) = \sum_i P(p_i, q) = 0.04$$

$$\begin{aligned}
P(q | p_1) &= \frac{P(p_1, q)}{P(q)} = 0.02 \\
P(q | p_2) &= \frac{P(p_2, q)}{P(q)} = 0.04 \\
P(q | p_3) &= \frac{P(p_3, q)}{P(q)} = 0.04
\end{aligned}$$

### 例題 12

2 つのサイコロを降る時、目の合計 $X$ に対する確率 $P(X)$ を求めなさい。

和が $X$ になる場合の数を考える

$X$ は整数とする

- $1 \le X \lt 7$ のとき: $X - 1$ よって $P(X) = \frac{X - 1}{36}$
- $7 \le X \le 12$ のとき: $13 - X$ よって $P(X) = \frac{13 - X}{36}$
- それ以外のとき: $0$ よって $P(X) = 0$

### 例題 13

ない

### 例題 14

- 0 を送る確率を 0.4
- 1 を送る確率を 0.6 とする

それぞれのメッセージでビット誤りの発生する確率は$P(\epsilon | 0) = 10^{-6}$ 、 $P(\epsilon | 1) = 10^{-4}$ とする。このときのビット誤り率 $P(\epsilon)$ を求めなさい。

$0.4 \times 10^{-6} + 0.6 \times 10^{-4}$

### 例題 15

4 つのコインを投げるとき、表の数 $X$ に対する確率関数 $P_x(x)$ および累積分布関数 $F_x(x)$ を求めなさい。

表が $x$ 枚でる確率

$$P_x(x) = \frac{{_4} {\rm C} {_x}}{2^4}$$

累積確率

$$F_x(x) = \sum_{y=0}^{x} P_x(y) = \sum_{y = 0}^{x} \frac{{_4} {\rm C} {_y}}{2^4}$$

### 例題 16

ある 2 値通信路において、 0 と 1 が等確率で伝送される。 1 と 0 はそれぞれパルス波形 $p(t)$ と $-p(t)$ で表され、各々のピークを $A_p$ 、 $-A_p$ とする。信号は波形がピークをとる時刻 $t = T_p$ でサンプリングされるが、ガウシアンノイズにより採取される値は $\pm A_p + n$ となる。 $n \sim N(0, \sigma_n^2)$ を仮定して、 0 と 1 を判定する閾値を 0 としたときのビット誤り率 $P(\epsilon)$ を求めなさい。

正規分布の累積密度関数を $F(x) = P(X \le x)$ とする。

- 1 のときの誤り率は、 $P(A_p + n \lt 0) = P(n \lt -A_p) = F(-A_p)$
- 0 は対称性より 1 と同じ

よって答えは $F(-A_p)$